webpackJsonp([18],{Zco7:function(e,t){},bfjS:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={computed:{},data:function(){return{labelPosition:"right",tableHeaderStyle:{"background-color":"#F1F1F1"},requestParam:{app_id:"",channel_code:""},responseData:{turntableConfig:{app_id:"",channel_code:"",interval:"",cfgval:[[]]}},see_action:!0,action:"",noData:!0}},methods:{getTurntableConfig:function(){var e=this;if(""!=this.requestParam.app_id&&""!=this.requestParam.channel_code){var t=this;this.$api.activity.turntableConfig(this.requestParam).then(function(a){1==a.data.success?null==a.data.data.turntableConfig?(e.responseData.turntableConfig={app_id:"",channel_code:"",interval:"",cfgval:[[]]},t.noData=!0):(t.noData=!1,t.responseData.turntableConfig.app_id=t.requestParam.app_id,t.responseData.turntableConfig.channel_code=t.requestParam.channel_code,t.responseData.turntableConfig.interval=a.data.data.turntableConfig.interval,t.responseData.turntableConfig.cfgval=a.data.data.turntableConfig.cfgval):e.$message({showClose:!0,message:"获取转盘配置失败",type:"error"})})}else this.$message({showClose:!0,message:"AppId和渠道码不能为空!",type:"error"})},updateTable:function(){this.see_action=!1,this.action="edit"},resetForm:function(){this.responseData.turntableConfig={app_id:"",channel_code:"",interval:"",cfgval:[[]]}},createTable:function(){var e=this;null!=this.responseData.turntableConfig&&"undefined"!=this.responseData.turntableConfig&&this.responseData.turntableConfig.cfgval.length>0&&this.$confirm("新增可能会丢失之前的配置,确定要新增吗？","新增").then(function(t){e.see_action=!1,e.action="add",e.resetForm()})},addDay:function(){this.responseData.turntableConfig.cfgval.push([{type:0,id:"",num:0,random:0}])},removeDay:function(e){this.responseData.turntableConfig.cfgval.splice(e,1)},addPart:function(e){this.responseData.turntableConfig.cfgval[e].push({type:0,id:"",num:0,random:0})},removePart:function(e){this.responseData.turntableConfig.cfgval[e].splice(this.responseData.turntableConfig.cfgval[e].length-1,1)},onSubmit:function(){var e=this,t=!0;if(this.responseData.turntableConfig.cfgval.forEach(function(e){var a=0;e.forEach(function(e){a+=parseInt(e.random)}),100!=a&&(t=!1)}),""===this.responseData.turntableConfig.interval||0==t)return this.$message({showClose:!0,message:0==t?"每组配置概念之和必须为100":"时间间隔不能设置为空",type:"error"}),!1;for(var a=this,n=0;n<this.responseData.turntableConfig.cfgval.length;n++)for(var o=0;o<this.responseData.turntableConfig.cfgval[n].length;o++)this.responseData.turntableConfig.cfgval[n][o].type=parseInt(this.responseData.turntableConfig.cfgval[n][o].type),this.responseData.turntableConfig.cfgval[n][o].num=parseInt(this.responseData.turntableConfig.cfgval[n][o].num),this.responseData.turntableConfig.cfgval[n][o].random=parseInt(this.responseData.turntableConfig.cfgval[n][o].random);this.$api.activity.setTurntableConfig(this.responseData.turntableConfig).then(function(t){!0===t.data.success?(e.$message({showClose:!0,message:"新增游戏成功",type:"success"}),a.action="",a.see_action=!0,a.noData=!1):e.$message({showClose:!0,message:"设置转盘配置失败",type:"error"})})}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"allPage"},[a("div",{staticClass:"core_container"},[a("div",{staticClass:"form_container"},[a("el-form",{staticClass:"demo-form-inline form_container_header",attrs:{inline:!0,model:e.requestParam,size:"mini"}},[a("el-form-item",{attrs:{label:"AppId",required:!0}},[a("el-input",{model:{value:e.requestParam.app_id,callback:function(t){e.$set(e.requestParam,"app_id",e._n(t))},expression:"requestParam.app_id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"渠道码",required:!0}},[a("el-input",{model:{value:e.requestParam.channel_code,callback:function(t){e.$set(e.requestParam,"channel_code",t)},expression:"requestParam.channel_code"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.getTurntableConfig}},[e._v("查询")])],1)],1)],1),e._v(" "),a("div",{staticClass:"form_container"},[a("el-form",{ref:"turntableConfig",staticClass:"formStyle text_common",attrs:{"label-position":e.labelPosition,"label-width":"100px",model:e.responseData.turntableConfig,size:"mini"}},[a("el-form-item",{attrs:{label:"操作"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:""==e.action&&!e.noData,expression:"action == '' && !noData"}],attrs:{type:"primary"},on:{click:e.updateTable}},[e._v("修改")]),e._v(" "),"edit"!=e.action?a("el-button",{attrs:{type:"success"},on:{click:e.createTable}},[e._v("新增")]):e._e(),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!(""==e.action),expression:"!(action == '')"}],attrs:{type:"success",disabled:e.see_action},on:{click:e.addDay}},[e._v("新增一天")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"edit"===e.action||"add"===e.action,expression:"action === 'edit' || action === 'add'"}],attrs:{type:"primary"},domProps:{textContent:e._s("add"===e.action?"确认新增":"确认修改")},on:{click:function(t){return e.onSubmit()}}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.noData||""!=e.action,expression:"!noData || action != ''"}],attrs:{label:"AppId",prop:"app_id"}},[a("el-input",{staticStyle:{width:"85%"},attrs:{disabled:e.see_action},model:{value:e.responseData.turntableConfig.app_id,callback:function(t){e.$set(e.responseData.turntableConfig,"app_id",e._n(t))},expression:"responseData.turntableConfig.app_id"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.noData||""!=e.action,expression:"!noData || action != ''"}],attrs:{label:"渠道码",prop:"channel_code"}},[a("el-input",{staticStyle:{width:"85%"},attrs:{placeholder:"可不传,传要确定正确!!!",disabled:e.see_action},model:{value:e.responseData.turntableConfig.channel_code,callback:function(t){e.$set(e.responseData.turntableConfig,"channel_code",t)},expression:"responseData.turntableConfig.channel_code"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!e.noData||""!=e.action,expression:"!noData || action != ''"}],attrs:{label:"抽奖间隔(秒)",prop:"interval"}},[a("el-input",{staticStyle:{width:"85%"},attrs:{disabled:e.see_action},model:{value:e.responseData.turntableConfig.interval,callback:function(t){e.$set(e.responseData.turntableConfig,"interval",e._n(t))},expression:"responseData.turntableConfig.interval"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"cfgval"}},e._l(e.responseData.turntableConfig.cfgval,function(t,n){return a("div",{key:n,staticClass:"every_day"},[a("div",{staticClass:"excuteDiv"},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:""!=e.action,expression:"action != ''"}],attrs:{type:"success",plain:"",disabled:e.see_action},on:{click:function(t){return e.addPart(n)}}},[e._v("新增一个奖品")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:""!=e.action,expression:"action != ''"}],attrs:{type:"warning",plain:"",disabled:e.see_action},on:{click:function(t){return e.removePart(n)}}},[e._v("移除一个奖品")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:""!=e.action,expression:"action != ''"}],attrs:{type:"danger",plain:"",disabled:e.see_action},on:{click:function(t){return e.removeDay(n)}}},[e._v("移除该天配置")]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[e._v(e._s(n+1))])],1),e._v(" "),a("el-table",{staticStyle:{width:"85%"},attrs:{data:t,border:"","header-cell-style":e.tableHeaderStyle}},[a("el-table-column",{attrs:{prop:"index",label:"排序",type:"index","highlight-current-row":"",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type","v-model":t[n],label:"物品类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{disabled:e.see_action},model:{value:t.row.type,callback:function(a){e.$set(t.row,"type",e._n(a))},expression:"scope.row.type"}})]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{prop:"id",label:"物品Id","v-model":t[n],align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{disabled:e.see_action},model:{value:t.row.id,callback:function(a){e.$set(t.row,"id",a)},expression:"scope.row.id"}})]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{prop:"num",label:"物品数量","v-model":t[n],align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{disabled:e.see_action},model:{value:t.row.num,callback:function(a){e.$set(t.row,"num",e._n(a))},expression:"scope.row.num"}})]}}],null,!0)}),e._v(" "),a("el-table-column",{attrs:{prop:"random",label:"获取概率","v-model":t[n],align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{disabled:e.see_action},model:{value:t.row.random,callback:function(a){e.$set(t.row,"random",e._n(a))},expression:"scope.row.random"}})]}}],null,!0)})],1)],1)}),0)],1)],1)])])},staticRenderFns:[]};var s=a("VU/8")(n,o,!1,function(e){a("Zco7")},"data-v-50d25f3c",null);t.default=s.exports}});