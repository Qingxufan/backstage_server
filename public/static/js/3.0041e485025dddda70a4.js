webpackJsonp([3],{BNR5:function(e,s,t){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a={computed:{},data:function(){return{labelPosition:"right",requestParam:{username:null,permission:this.$store.getters["user/getUser"].permission},User:{status:null,permission:null,_id:null,uid:null,username:null,password:null,show_password:null},dialogFormVisible:!1,responseData:[],page:{list:[],current_page:1,total:0,page_size:8},action:{type:"",title:""},user:this.$store.getters["user/getUser"]}},methods:{getUserList:function(){var e=this,s=this;s.responseData=[],this.$api.user.list(this.requestParam).then(function(t){if(200===t.data.code){s.responseData=t.data.data,s.page.total=s.responseData.length;var a=(s.page.current_page-1)*s.page.page_size,r=s.page.total>s.page.current_page*s.page.page_size?s.page.current_page*s.page.page_size:s.responseData.length;s.page.list=s.responseData.slice(a,r)}else e.$message({showClose:!0,message:"获取用户列表失败",type:"error"})})},showEdit:function(e,s){var t=this;this.resetUser(),"add"==e?(this.dialogFormVisible=!0,this.action.type=e,this.action.title="新增用户"):(this.$api.user.list({username:s}).then(function(e){200===e.data.code?t.User=e.data.data[0]:t.$message({showClose:!0,message:"获取失败,请重试!",type:"error"})}),this.dialogFormVisible=!0,this.action.type=e,this.action.title="更新用户")},resetUser:function(){this.User={status:null,permission:null,_id:null,uid:null,username:null,password:null}},commitUser:function(){"add"==this.action.type?this.addUser():this.updateUser()},addUser:function(){var e=this,s=this;this.User._id=null,this.User.uid=null,this.User.permission<=this.$store.getters["user/getUser"].permission?this.$message({showClose:!0,message:"设置权限不合法",type:"error"}):(this.User.show_password=this.User.show_password||"123456",this.User.password=this.$md5(this.User.show_password),this.$api.user.register(this.User).then(function(t){200===t.data.code?(e.$message({showClose:!0,message:"新增成功",type:"success"}),s.dialogFormVisible=!1,s.resetUser()):e.$message({showClose:!0,message:"新增失败",type:"error"})}))},updateUser:function(){var e=this,s=this;if(this.User.show_password=this.User.show_password.replace(/\s/g,""),this.User.permission>=this.$store.getters["user/getUser"].permission)this.$message({showClose:!0,message:"设置权限不合法",type:"error"});else{var t={};t.permission=this.User.permission,this.User.show_password&&(t.password=this.$md5(this.User.show_password)),t.status=this.User.status,t.username=this.User.username,this.$api.user.update(t).then(function(t){200===t.data.code?(e.$message({showClose:!0,message:"修改成功",type:"success"}),s.dialogFormVisible=!1,s.resetUser()):e.$message({showClose:!0,message:"修改失败",type:"error"})})}},resetForm:function(e){this.$refs[e].resetFields()},tableRowClassName:function(e){e.row;var s=e.rowIndex;return s%4==1?"warning-row":s%4==3?"success-row":""},prePage:function(){this.page.current_page>0&&(this.page.current_page--,this.page.list=this.responseData.slice((this.page.current_page-1)*this.page.page_size,this.responseData.length>this.page.current_page*this.page.page_size?this.page.current_page*this.page.page_size:this.responseData.length))},thisPage:function(e){this.page.current_page=e,this.page.list=this.responseData.slice((this.page.current_page-1)*this.page.page_size,this.responseData.length>this.page.current_page*this.page.page_size?this.page.current_page*this.page.page_size:this.responseData.length)},nextPage:function(){this.page.current_page<Math.ceil(this.page.total/this.page.page_size)&&(this.page.current_page++,this.page.list=this.responseData.slice((this.page.current_page-1)*this.page.page_size,this.responseData.length>this.page.current_page*this.page.page_size?this.page.current_page*this.page.page_size:this.responseData.length))}}},r={render:function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"allPage"},[t("div",{staticClass:"core_container"},[t("div",{staticClass:"form_container"},[t("el-form",{staticClass:"demo-form-inline form_container_header",attrs:{inline:!0,model:e.requestParam,size:"mini"}},[t("el-form-item",{attrs:{label:"用户账号"}},[t("el-input",{model:{value:e.requestParam.username,callback:function(s){e.$set(e.requestParam,"username",s)},expression:"requestParam.username"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.getUserList}},[e._v("查询")])],1)],1)],1),e._v(" "),t("div",{staticClass:"showDataTab"},[t("el-button",{attrs:{type:"success",size:"small"},on:{click:function(s){return e.showEdit("add",null)}}},[e._v("新增用户")]),e._v(" "),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.page.list,"row-class-name":e.tableRowClassName}},[t("el-table-column",{attrs:{prop:"uid",label:"用户ID",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"username",label:"账号",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"permission",label:"权限等级",align:"center"}}),e._v(" "),t("el-table-column",{attrs:{label:"用户状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",[0==s.row.status?t("span",[e._v("删除")]):1==s.row.status?t("span",[e._v("正常")]):t("span",[e._v("未知状态"+e._s(s.row.status))])])]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.showEdit("update",s.row.username)}}},[e._v("编辑")])]}}])})],1),e._v(" "),t("el-dialog",{attrs:{title:e.action.title,visible:e.dialogFormVisible,"show-close:true":""},on:{"update:visible":function(s){e.dialogFormVisible=s}}},[t("el-form",{ref:"game",staticClass:"formStyle text_common",attrs:{"label-position":e.labelPosition,"label-width":"100px",model:e.User,size:"mini"}},[t("el-form-item",{attrs:{label:"账号",prop:"username",required:!0}},[t("el-input",{attrs:{disabled:"update"==e.action.type},model:{value:e.User.username,callback:function(s){e.$set(e.User,"username",e._n(s))},expression:"User.username"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"密码",prop:"show_password"}},[t("el-input",{attrs:{placeholder:"不填则默认密码：123456"},model:{value:e.User.show_password,callback:function(s){e.$set(e.User,"show_password",s)},expression:"User.show_password"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"状态",prop:"status"}},[t("el-radio-group",{attrs:{size:"medium"},model:{value:e.User.status,callback:function(s){e.$set(e.User,"status",e._n(s))},expression:"User.status"}},[t("el-radio",{attrs:{border:"",label:0}},[e._v("不可用")]),e._v(" "),t("el-radio",{attrs:{border:"",label:1}},[e._v("正常")])],1)],1),e._v(" "),t("el-form-item",{attrs:{label:"权限等级",prop:"permission"}},[t("el-input-number",{attrs:{min:e.user.permission+1,max:10,label:"描述文字"},model:{value:e.User.permission,callback:function(s){e.$set(e.User,"permission",s)},expression:"User.permission"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.commitUser}},[e._v("提交")]),e._v(" "),t("el-button",{attrs:{type:"danger",size:"medium"},on:{click:function(s){return e.resetForm("User")}}},[e._v("重置")])],1)],1)],1)],1),e._v(" "),t("div",{staticClass:"pageBar"},[t("el-pagination",{attrs:{background:"","hide-on-single-page":"",layout:"prev, pager, next","current-page":e.page.current_page,"page-size":e.page.page_size,total:e.page.total},on:{"next-click":e.nextPage,"current-change":e.thisPage,"prev-click":e.prePage}})],1)])])},staticRenderFns:[]};var i=t("VU/8")(a,r,!1,function(e){t("zOBn")},"data-v-714bd119",null);s.default=i.exports},zOBn:function(e,s){}});
//# sourceMappingURL=3.0041e485025dddda70a4.js.map